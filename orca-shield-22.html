<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ORCA // EDGAR_VISION_V22</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        :root {
            /* HOLLER NOIR */
            --bg-deep: #050510;
            --text-gold: #ffd700;
            --text-cyan: #00ffff;
            --text-alert: #ff4444;
            --panel-bg: rgba(20, 20, 30, 0.9);

            /* VISION MODES */
            --vis-human: #333;
            --vis-edgar: #ffd700;
            --vis-cold: #00bfff;

            --font-head: 'Impact', sans-serif;
            --font-body: 'Courier New', monospace;
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-deep);
            color: #eee;
            font-family: var(--font-body);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- UI LAYOUT --- */
        .top-bar {
            height: 50px;
            background: #111;
            border-bottom: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .logo {
            color: var(--text-gold);
            font-family: var(--font-head);
            letter-spacing: 2px;
        }

        .main-stage {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .nav-tabs {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        .tab-btn {
            background: #222;
            border: 1px solid #444;
            color: #888;
            padding: 8px 16px;
            cursor: pointer;
            font-family: var(--font-head);
            text-transform: uppercase;
        }

        .tab-btn.active {
            background: var(--text-gold);
            color: #000;
            border-color: var(--text-gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        /* --- VIEWS --- */
        .view-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background: #000;
        }

        .view-layer.active {
            display: flex;
        }

        /* VIEW: PODCAST */
        #view-podcast {
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .viz-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 2px solid var(--text-cyan);
            box-shadow: 0 0 30px var(--text-cyan);
            margin-bottom: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
        }

        .script-box {
            width: 80%;
            max-width: 600px;
            height: 150px;
            overflow: hidden;
            color: var(--text-cyan);
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
            font-size: 1.1rem;
            line-height: 1.5;
        }

        /* VIEW: EVIDENCE */
        #view-evidence {
            padding: 80px 40px;
            overflow-y: auto;
            background: #1a1a1a;
        }

        .doc-card {
            background: #eee;
            color: #111;
            padding: 20px;
            margin-bottom: 20px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 5px 20px #000;
            position: relative;
        }

        .doc-stamp {
            position: absolute;
            top: 10px;
            right: 10px;
            border: 2px solid var(--text-alert);
            color: var(--text-alert);
            font-family: var(--font-head);
            transform: rotate(-15deg);
            padding: 5px;
            opacity: 0.8;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        th {
            background: #ccc;
            text-align: left;
            padding: 5px;
        }

        td {
            border-bottom: 1px solid #ddd;
            padding: 5px;
        }

        .row-cold {
            background: rgba(0, 191, 255, 0.2);
        }

        /* VIEW: EDGAR-VISION */
        #view-vision {
            cursor: crosshair;
        }

        #vision-canvas {
            width: 100%;
            height: 100%;
        }

        .vision-toggle {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #555;
            padding: 5px;
            border-radius: 30px;
            display: flex;
            gap: 5px;
        }

        .toggle-opt {
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            color: #888;
            font-weight: bold;
        }

        .toggle-opt.active {
            color: #000;
        }

        #opt-human.active {
            background: #fff;
        }

        #opt-edgar.active {
            background: var(--text-gold);
            box-shadow: 0 0 15px var(--text-gold);
        }

        .hud-scanner {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--text-cyan);
            padding: 15px;
            width: 250px;
            font-size: 0.8rem;
            pointer-events: none;
        }
    </style>
</head>

<body>

    <div class="top-bar">
        <div class="logo">HOLLER ARCHIVIST // CASE #22</div>
        <div style="color: #666;">STATUS: UNRESOLVED</div>
    </div>

    <div class="main-stage">
        <div class="nav-tabs">
            <div class="tab-btn active" onclick="App.setMode('PODCAST')">PODCAST</div>
            <div class="tab-btn" onclick="App.setMode('EVIDENCE')">EVIDENCE</div>
            <div class="tab-btn" onclick="App.setMode('VISION')">EDGAR-VISION</div>
        </div>

        <!-- PODCAST -->
        <div id="view-podcast" class="view-layer active">
            <div class="viz-circle" id="viz-circle">üéôÔ∏è</div>
            <div class="script-box" id="script-box">
                > INITIALIZING AUDIO STREAM...<br>
                > LOADING "BALLAD OF THE GOLDEN HOUND"...
            </div>
            <button onclick="Podcast.play()"
                style="margin-top: 30px; padding: 10px 30px; background: transparent; border: 1px solid var(--text-cyan); color: var(--text-cyan); font-family: inherit; cursor: pointer;">PLAY
                EPISODE 1 & 2</button>
        </div>

        <!-- EVIDENCE -->
        <div id="view-evidence" class="view-layer">
            <!-- EXHIBIT A -->
            <div class="doc-card">
                <div class="doc-stamp">EXHIBIT A</div>
                <h3>SMART-HOME SECURITY LOG</h3>
                <div style="font-size:0.8rem; color:#555;">SOURCE: LIVING ROOM HUB</div>
                <table>
                    <tr>
                        <th>TIME</th>
                        <th>EVENT</th>
                        <th>DATA</th>
                    </tr>
                    <tr>
                        <td>4:00 PM</td>
                        <td>Door Lock</td>
                        <td>SECURE</td>
                    </tr>
                    <tr>
                        <td>4:02 PM</td>
                        <td>Light Sensor</td>
                        <td>0% (DARK)</td>
                    </tr>
                    <tr style="background:#ffcccc;">
                        <td>4:03 PM</td>
                        <td>Audio Sensor</td>
                        <td>95dB (IMPACT)</td>
                    </tr>
                </table>
            </div>

            <!-- EXHIBIT B -->
            <div class="doc-card">
                <div class="doc-stamp" style="color:blue; border-color:blue;">EXHIBIT B</div>
                <h3>THERMOSTAT LOGS</h3>
                <div style="font-size:0.8rem; color:#555;">SOURCE: NEST-X SENSOR</div>
                <table>
                    <tr>
                        <th>TIME</th>
                        <th>TEMP</th>
                        <th>STATUS</th>
                    </tr>
                    <tr>
                        <td>4:01 PM</td>
                        <td>72¬∞F</td>
                        <td>IDLE</td>
                    </tr>
                    <tr class="row-cold">
                        <td>4:02 PM</td>
                        <td>68¬∞F</td>
                        <td>DROP DETECTED</td>
                    </tr>
                    <tr class="row-cold" style="font-weight:bold;">
                        <td>4:02:05 PM</td>
                        <td>52¬∞F</td>
                        <td>ERR: -20¬∞F DELTA</td>
                    </tr>
                    <tr>
                        <td>4:03 PM</td>
                        <td>52¬∞F</td>
                        <td>HEATING ON</td>
                    </tr>
                </table>
                <p style="font-style:italic; font-size: 0.9rem; margin-top: 10px;">
                    "Thermodynamics. Heat doesn't just disappear. Something absorbed it."
                </p>
            </div>
        </div>

        <!-- EDGAR VISION -->
        <div id="view-vision" class="view-layer">
            <canvas id="vision-canvas"></canvas>

            <div class="vision-toggle">
                <div id="opt-human" class="toggle-opt active" onclick="Vision.setMode('HUMAN')">HUMAN EYE</div>
                <div id="opt-edgar" class="toggle-opt" onclick="Vision.setMode('EDGAR')">EDGAR VISION</div>
            </div>

            <div class="hud-scanner">
                <div style="color: #888; border-bottom: 1px solid #555; margin-bottom: 5px;">SCANNER DATA</div>
                <div id="scan-target">-</div>
                <div id="scan-physics" style="color: var(--text-cyan); margin-top: 5px;"></div>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT = [
            "NARRATOR: It started on a Tuesday.",
            "The humidity was at 80%.",
            "Mark left. The laws of physics broken.",
            "Edgar didn't run. He was ERASED.",
            "--- EPISODE 2: THE COLD SNAP ---",
            "At 4:02 PM, the room got COLD.",
            "From 72 to 52 degrees in seconds.",
            "Thermodynamics says energy cannot be destroyed.",
            "So where did the heat go?",
            "It was absorbed. Something entered."
        ];

        // --- AUDIO ---
        const AudioEngine = {
            init() {
                Tone.start();
                this.drone = new Tone.Oscillator(100, "sine").toDestination();
                this.drone.volume.value = -30;
                this.clicks = new Tone.MembraneSynth().toDestination();
            },
            playTick() {
                this.clicks.triggerAttackRelease("C6", "32n", Tone.now(), 0.1);
            },
            playDrone(active) {
                if (active) this.drone.start();
                else this.drone.stop();
            }
        };

        // --- PODCAST ---
        const Podcast = {
            play() {
                AudioEngine.init();
                let i = 0;
                const box = document.getElementById('script-box');
                const viz = document.getElementById('viz-circle');

                box.innerHTML = "";

                const interval = setInterval(() => {
                    if (i >= SCRIPT.length) { clearInterval(interval); return; }

                    const p = document.createElement('div');
                    p.innerText = SCRIPT[i];
                    p.style.opacity = 0;
                    p.style.transition = "opacity 1s";
                    box.appendChild(p);

                    // Fade in
                    setTimeout(() => p.style.opacity = 1, 100);

                    // Auto scroll
                    box.scrollTop = box.scrollHeight;

                    // Viz Pulse
                    viz.style.transform = `scale(${1 + Math.random() * 0.2})`;

                    i++;
                }, 2000);
            }
        };

        // --- VISION ENGINE ---
        const Vision = {
            canvas: document.getElementById('vision-canvas'),
            ctx: document.getElementById('vision-canvas').getContext('2d'),
            mode: 'HUMAN',
            items: [],

            init() {
                this.resize();
                window.addEventListener('resize', () => this.resize());

                // Define Room Items
                this.items = [
                    { id: 'chair', x: 200, y: 300, w: 60, h: 80, name: "Displaced Chair", human: "#444", edgar: "#ff00ff", note: "Moved 2 inches. Shadow Anomaly." },
                    { id: 'puddle', x: 500, y: 400, w: 100, h: 60, name: "Oil Puddle", human: "#333", edgar: "rainbow", note: "Thin-Film Interference (Rainbow)." },
                    { id: 'spot', x: 600, y: 200, w: 150, h: 150, name: "Cold Spot", human: "transparent", edgar: "blue", note: "-20¬∞F Delta. Heat Absorption." },
                    { id: 'trail', x: 300, y: 450, w: 200, h: 20, name: "Phosphor Trail", human: "transparent", edgar: "#00ff00", note: "Glow-Ball Residue." }
                ];

                this.canvas.addEventListener('mousemove', e => {
                    const rect = this.canvas.getBoundingClientRect();
                    const mx = e.clientX - rect.left;
                    const my = e.clientY - rect.top;
                    this.checkHover(mx, my);
                });

                this.loop();
            },

            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            },

            setMode(m) {
                this.mode = m;
                document.getElementById('opt-human').className = m === 'HUMAN' ? 'toggle-opt active' : 'toggle-opt';
                document.getElementById('opt-edgar').className = m === 'EDGAR' ? 'toggle-opt active' : 'toggle-opt';

                if (m === 'EDGAR') {
                    AudioEngine.playDrone(true);
                    document.body.style.backgroundColor = "#000";
                } else {
                    AudioEngine.playDrone(false);
                    document.body.style.backgroundColor = "#050510";
                }
            },

            checkHover(mx, my) {
                let hit = null;
                this.items.forEach(item => {
                    // Simple box hit
                    if (mx > item.x && mx < item.x + item.w && my > item.y && my < item.y + item.h) {
                        hit = item;
                    }
                });

                const targetEl = document.getElementById('scan-target');
                const physEl = document.getElementById('scan-physics');

                if (hit) {
                    // Visibility Logic
                    if (this.mode === 'HUMAN' && (hit.human === 'transparent')) {
                        targetEl.innerText = "NOTHING VISIBLE";
                        physEl.innerText = "Normal Spectrum";
                    } else {
                        targetEl.innerText = hit.name;
                        physEl.innerText = hit.note;
                        if (this.mode === 'EDGAR') AudioEngine.playTick();
                    }
                } else {
                    targetEl.innerText = "SCANNING...";
                    physEl.innerText = "Flux: Stable";
                }
            },

            loop() {
                requestAnimationFrame(() => this.loop());
                if (!document.getElementById('view-vision').classList.contains('active')) return;

                const w = this.canvas.width;
                const h = this.canvas.height;
                const ctx = this.ctx;

                // BG
                ctx.fillStyle = this.mode === 'HUMAN' ? "#111" : "#000";
                ctx.fillRect(0, 0, w, h);

                // Room Lines
                ctx.strokeStyle = this.mode === 'HUMAN' ? "#333" : "#004400";
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(100, 100); ctx.lineTo(100, h - 100); // Wall
                ctx.moveTo(100, h - 100); ctx.lineTo(w - 100, h - 100); // Floor
                ctx.stroke();

                // Draw Items
                this.items.forEach(item => {
                    ctx.save();

                    if (this.mode === 'HUMAN') {
                        if (item.human !== 'transparent') {
                            ctx.fillStyle = item.human;
                            ctx.fillRect(item.x, item.y, item.w, item.h);
                        }
                    } else {
                        // Edgar Vision
                        if (item.edgar === 'rainbow') {
                            const grad = ctx.createLinearGradient(item.x, item.y, item.x + item.w, item.y);
                            grad.addColorStop(0, "red"); grad.addColorStop(0.2, "orange"); grad.addColorStop(0.4, "yellow");
                            grad.addColorStop(0.6, "green"); grad.addColorStop(0.8, "blue"); grad.addColorStop(1, "violet");
                            ctx.fillStyle = grad;
                            ctx.globalAlpha = 0.6;
                            ctx.fillRect(item.x, item.y, item.w, item.h);
                        } else if (item.edgar === 'blue') {
                            // Cold Spot (Thermal)
                            const grad = ctx.createRadialGradient(item.x + item.w / 2, item.y + item.h / 2, 10, item.x + item.w / 2, item.y + item.h / 2, item.w / 2);
                            grad.addColorStop(0, "rgba(0,191,255,0.8)");
                            grad.addColorStop(1, "rgba(0,0,50,0)");
                            ctx.fillStyle = grad;
                            ctx.fillRect(item.x, item.y, item.w, item.h);
                        } else {
                            ctx.strokeStyle = item.edgar;
                            ctx.lineWidth = 2;
                            ctx.strokeRect(item.x, item.y, item.w, item.h);
                            ctx.fillStyle = item.edgar;
                            ctx.globalAlpha = 0.1;
                            ctx.fillRect(item.x, item.y, item.w, item.h);
                        }
                    }

                    ctx.restore();
                });

                // Scanlines for Edgar
                if (this.mode === 'EDGAR') {
                    ctx.fillStyle = "rgba(255, 215, 0, 0.05)";
                    ctx.fillRect(0, (Date.now() / 5) % h, w, 2);
                }
            }
        };

        const App = {
            setMode(m) {
                document.querySelectorAll('.view-layer').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

                if (m === 'PODCAST') document.getElementById('view-podcast').classList.add('active');
                if (m === 'EVIDENCE') document.getElementById('view-evidence').classList.add('active');
                if (m === 'VISION') {
                    document.getElementById('view-vision').classList.add('active');
                    Vision.init();
                }

                // Highlight Tab
                const tabs = document.querySelectorAll('.tab-btn');
                if (m === 'PODCAST') tabs[0].classList.add('active');
                if (m === 'EVIDENCE') tabs[1].classList.add('active');
                if (m === 'VISION') tabs[2].classList.add('active');
            }
        };

    </script>
</body>

</html>